position_detail_order_yesterday = [{'TradingDay': '20170410', 'VolumeTotal': 0, 'StrategyID': '01', 'OrderStatus': '0', 'CombHedgeFlag': '1', 'LimitPrice': 15670.0, 'OrderRef': '100000005401', 'InsertDate': '20170410', 'UserID': '063802', 'InsertTime': '14:05:10', 'CombOffsetFlag': '0', 'InstrumentID': 'ru1709', 'VolumeTraded': 2, 'TradingDayRecord': '20170410', 'VolumeTotalOriginal': 2, 'Direction': '1', 'VolumeTradedBatch': 2}, {'TradingDay': '20170410', 'VolumeTotal': 0, 'StrategyID': '01', 'OrderStatus': '0', 'CombHedgeFlag': '1', 'LimitPrice': 15125.0, 'OrderRef': '100000005501', 'InsertDate': '20170410', 'UserID': '063802', 'InsertTime': '14:05:10', 'CombOffsetFlag': '0', 'InstrumentID': 'ru1705', 'VolumeTraded': 2, 'TradingDayRecord': '20170410', 'VolumeTotalOriginal': 2, 'Direction': '1', 'VolumeTradedBatch': 2}, {'TradingDay': '20170410', 'VolumeTotal': 0, 'StrategyID': '01', 'OrderStatus': '0', 'CombHedgeFlag': '1', 'LimitPrice': 15665.0, 'OrderRef': '100000005601', 'InsertDate': '20170410', 'UserID': '063802', 'InsertTime': '14:05:11', 'CombOffsetFlag': '0', 'InstrumentID': 'ru1709', 'VolumeTraded': 1, 'TradingDayRecord': '20170410', 'VolumeTotalOriginal': 1, 'Direction': '1', 'VolumeTradedBatch': 1}, {'TradingDay': '20170410', 'VolumeTotal': 0, 'StrategyID': '01', 'OrderStatus': '0', 'CombHedgeFlag': '1', 'LimitPrice': 15125.0, 'OrderRef': '100000005701', 'InsertDate': '20170410', 'UserID': '063802', 'InsertTime': '14:05:11', 'CombOffsetFlag': '0', 'InstrumentID': 'ru1705', 'VolumeTraded': 1, 'TradingDayRecord': '20170410', 'VolumeTotalOriginal': 1, 'Direction': '1', 'VolumeTradedBatch': 1}, {'TradingDay': '20170410', 'VolumeTotal': 0, 'StrategyID': '01', 'OrderStatus': '0', 'CombHedgeFlag': '1', 'LimitPrice': 15530.0, 'OrderRef': '100000008401', 'InsertDate': '20170410', 'UserID': '063802', 'InsertTime': '14:24:38', 'CombOffsetFlag': '0', 'InstrumentID': 'ru1709', 'VolumeTraded': 2, 'TradingDayRecord': '20170410', 'VolumeTotalOriginal': 2, 'Direction': '1', 'VolumeTradedBatch': 2}, {'TradingDay': '20170410', 'VolumeTotal': 0, 'StrategyID': '01', 'OrderStatus': '0', 'CombHedgeFlag': '1', 'LimitPrice': 14985.0, 'OrderRef': '100000008501', 'InsertDate': '20170410', 'UserID': '063802', 'InsertTime': '14:24:38', 'CombOffsetFlag': '0', 'InstrumentID': 'ru1705', 'VolumeTraded': 2, 'TradingDayRecord': '20170410', 'VolumeTotalOriginal': 2, 'Direction': '1', 'VolumeTradedBatch': 2}, {'TradingDay': '20170410', 'VolumeTotal': 0, 'StrategyID': '01', 'OrderStatus': '0', 'CombHedgeFlag': '1', 'LimitPrice': 15530.0, 'OrderRef': '100000008601', 'InsertDate': '20170410', 'UserID': '063802', 'InsertTime': '14:24:38', 'CombOffsetFlag': '0', 'InstrumentID': 'ru1709', 'VolumeTraded': 1, 'TradingDayRecord': '20170410', 'VolumeTotalOriginal': 1, 'Direction': '1', 'VolumeTradedBatch': 1}, {'TradingDay': '20170410', 'VolumeTotal': 0, 'StrategyID': '01', 'OrderStatus': '0', 'CombHedgeFlag': '1', 'LimitPrice': 14985.0, 'OrderRef': '100000008701', 'InsertDate': '20170410', 'UserID': '063802', 'InsertTime': '14:24:38', 'CombOffsetFlag': '0', 'InstrumentID': 'ru1705', 'VolumeTraded': 1, 'TradingDayRecord': '20170410', 'VolumeTotalOriginal': 1, 'Direction': '1', 'VolumeTradedBatch': 1}, {'TradingDay': '20170410', 'VolumeTotal': 0, 'StrategyID': '01', 'OrderStatus': '0', 'CombHedgeFlag': '1', 'LimitPrice': 15525.0, 'OrderRef': '100000008801', 'InsertDate': '20170410', 'UserID': '063802', 'InsertTime': '14:24:52', 'CombOffsetFlag': '0', 'InstrumentID': 'ru1709', 'VolumeTraded': 2, 'TradingDayRecord': '20170410', 'VolumeTotalOriginal': 2, 'Direction': '1', 'VolumeTradedBatch': 2}, {'TradingDay': '20170410', 'VolumeTotal': 0, 'StrategyID': '01', 'OrderStatus': '0', 'CombHedgeFlag': '1', 'LimitPrice': 14980.0, 'OrderRef': '100000008901', 'InsertDate': '20170410', 'UserID': '063802', 'InsertTime': '14:24:52', 'CombOffsetFlag': '0', 'InstrumentID': 'ru1705', 'VolumeTraded': 2, 'TradingDayRecord': '20170410', 'VolumeTotalOriginal': 2, 'Direction': '1', 'VolumeTradedBatch': 2}, {'TradingDay': '20170410', 'VolumeTotal': 0, 'StrategyID': '01', 'OrderStatus': '0', 'CombHedgeFlag': '1', 'LimitPrice': 15525.0, 'OrderRef': '100000009001', 'InsertDate': '20170410', 'UserID': '063802', 'InsertTime': '14:24:53', 'CombOffsetFlag': '0', 'InstrumentID': 'ru1709', 'VolumeTraded': 1, 'TradingDayRecord': '20170410', 'VolumeTotalOriginal': 1, 'Direction': '1', 'VolumeTradedBatch': 1}, {'TradingDay': '20170410', 'VolumeTotal': 0, 'StrategyID': '01', 'OrderStatus': '0', 'CombHedgeFlag': '1', 'LimitPrice': 14980.0, 'OrderRef': '100000009101', 'InsertDate': '20170410', 'UserID': '063802', 'InsertTime': '14:24:53', 'CombOffsetFlag': '0', 'InstrumentID': 'ru1705', 'VolumeTraded': 1, 'TradingDayRecord': '20170410', 'VolumeTotalOriginal': 1, 'Direction': '1', 'VolumeTradedBatch': 1}, {'TradingDay': '20170410', 'VolumeTotal': 0, 'StrategyID': '01', 'OrderStatus': '0', 'CombHedgeFlag': '1', 'LimitPrice': 15535.0, 'OrderRef': '100000009301', 'InsertDate': '20170410', 'UserID': '063802', 'InsertTime': '14:25:09', 'CombOffsetFlag': '0', 'InstrumentID': 'ru1709', 'VolumeTraded': 1, 'TradingDayRecord': '20170410', 'VolumeTotalOriginal': 1, 'Direction': '1', 'VolumeTradedBatch': 1}, {'TradingDay': '20170410', 'VolumeTotal': 0, 'StrategyID': '01', 'OrderStatus': '0', 'CombHedgeFlag': '1', 'LimitPrice': 14970.0, 'OrderRef': '100000009401', 'InsertDate': '20170410', 'UserID': '063802', 'InsertTime': '14:25:09', 'CombOffsetFlag': '0', 'InstrumentID': 'ru1705', 'VolumeTraded': 1, 'TradingDayRecord': '20170410', 'VolumeTotalOriginal': 1, 'Direction': '1', 'VolumeTradedBatch': 1}]
position_detail_trade_yesterday = [{'Volume': 2, 'TradeDate': '20170410', 'TradingDay': '20170410', 'OrderRef': '100000005401', 'OffsetFlag': '', 'UserID': '063802', 'HedgeFlag': '', 'InstrumentID': 'ru1709', 'Price': 15670.0, 'TradingDayRecord': '20170410', 'StrategyID': '01', 'Direction': '1'}, {'Volume': 2, 'TradeDate': '20170410', 'TradingDay': '20170410', 'OrderRef': '100000005501', 'OffsetFlag': '', 'UserID': '063802', 'HedgeFlag': '', 'InstrumentID': 'ru1705', 'Price': 15120.0, 'TradingDayRecord': '20170410', 'StrategyID': '01', 'Direction': '1'}, {'Volume': 1, 'TradeDate': '20170410', 'TradingDay': '20170410', 'OrderRef': '100000005601', 'OffsetFlag': '', 'UserID': '063802', 'HedgeFlag': '', 'InstrumentID': 'ru1709', 'Price': 15670.0, 'TradingDayRecord': '20170410', 'StrategyID': '01', 'Direction': '1'}, {'Volume': 1, 'TradeDate': '20170410', 'TradingDay': '20170410', 'OrderRef': '100000005701', 'OffsetFlag': '', 'UserID': '063802', 'HedgeFlag': '', 'InstrumentID': 'ru1705', 'Price': 15125.0, 'TradingDayRecord': '20170410', 'StrategyID': '01', 'Direction': '1'}, {'Volume': 2, 'TradeDate': '20170410', 'TradingDay': '20170410', 'OrderRef': '100000008401', 'OffsetFlag': '', 'UserID': '063802', 'HedgeFlag': '', 'InstrumentID': 'ru1709', 'Price': 15530.0, 'TradingDayRecord': '20170410', 'StrategyID': '01', 'Direction': '1'}, {'Volume': 2, 'TradeDate': '20170410', 'TradingDay': '20170410', 'OrderRef': '100000008501', 'OffsetFlag': '', 'UserID': '063802', 'HedgeFlag': '', 'InstrumentID': 'ru1705', 'Price': 14985.0, 'TradingDayRecord': '20170410', 'StrategyID': '01', 'Direction': '1'}, {'Volume': 1, 'TradeDate': '20170410', 'TradingDay': '20170410', 'OrderRef': '100000008601', 'OffsetFlag': '', 'UserID': '063802', 'HedgeFlag': '', 'InstrumentID': 'ru1709', 'Price': 15530.0, 'TradingDayRecord': '20170410', 'StrategyID': '01', 'Direction': '1'}, {'Volume': 1, 'TradeDate': '20170410', 'TradingDay': '20170410', 'OrderRef': '100000008701', 'OffsetFlag': '', 'UserID': '063802', 'HedgeFlag': '', 'InstrumentID': 'ru1705', 'Price': 14985.0, 'TradingDayRecord': '20170410', 'StrategyID': '01', 'Direction': '1'}, {'Volume': 2, 'TradeDate': '20170410', 'TradingDay': '20170410', 'OrderRef': '100000008801', 'OffsetFlag': '', 'UserID': '063802', 'HedgeFlag': '', 'InstrumentID': 'ru1709', 'Price': 15525.0, 'TradingDayRecord': '20170410', 'StrategyID': '01', 'Direction': '1'}, {'Volume': 2, 'TradeDate': '20170410', 'TradingDay': '20170410', 'OrderRef': '100000008901', 'OffsetFlag': '', 'UserID': '063802', 'HedgeFlag': '', 'InstrumentID': 'ru1705', 'Price': 14980.0, 'TradingDayRecord': '20170410', 'StrategyID': '01', 'Direction': '1'}, {'Volume': 1, 'TradeDate': '20170410', 'TradingDay': '20170410', 'OrderRef': '100000009001', 'OffsetFlag': '', 'UserID': '063802', 'HedgeFlag': '', 'InstrumentID': 'ru1709', 'Price': 15525.0, 'TradingDayRecord': '20170410', 'StrategyID': '01', 'Direction': '1'}, {'Volume': 1, 'TradeDate': '20170410', 'TradingDay': '20170410', 'OrderRef': '100000009101', 'OffsetFlag': '', 'UserID': '063802', 'HedgeFlag': '', 'InstrumentID': 'ru1705', 'Price': 14980.0, 'TradingDayRecord': '20170410', 'StrategyID': '01', 'Direction': '1'}, {'Volume': 1, 'TradeDate': '20170410', 'TradingDay': '20170410', 'OrderRef': '100000009301', 'OffsetFlag': '', 'UserID': '063802', 'HedgeFlag': '', 'InstrumentID': 'ru1709', 'Price': 15535.0, 'TradingDayRecord': '20170410', 'StrategyID': '01', 'Direction': '1'}, {'Volume': 1, 'TradeDate': '20170410', 'TradingDay': '20170410', 'OrderRef': '100000009401', 'OffsetFlag': '', 'UserID': '063802', 'HedgeFlag': '', 'InstrumentID': 'ru1705', 'Price': 14970.0, 'TradingDayRecord': '20170410', 'StrategyID': '01', 'Direction': '1'}]
len_order = len(position_detail_order_yesterday)
len_trade = len(position_detail_trade_yesterday)
print("len_order =", len_order)
print("len_trade =", len_trade)
ru1709_sell_yesterday = 0
ru1705_sell_yesterday = 0
ru1709_buy_yesterday = 0
ru1705_buy_yesterday = 0
print("position_detail_order_yesterday")
for i in position_detail_order_yesterday:
    print(i)
    if i['InstrumentID'] == 'ru1709' and i['Direction'] == '1':
        ru1709_sell_yesterday += i['VolumeTradedBatch']
    elif i['InstrumentID'] == 'ru1705' and i['Direction'] == '1':
        ru1705_sell_yesterday += i['VolumeTradedBatch']
    elif i['InstrumentID'] == 'ru1709' and i['Direction'] == '0':
        ru1709_buy_yesterday += i['VolumeTradedBatch']
    elif i['InstrumentID'] == 'ru1705' and i['Direction'] == '0':
        ru1705_buy_yesterday += i['VolumeTradedBatch']
print("ru1709_sell_yesterday =", ru1709_sell_yesterday)
print("ru1705_sell_yesterday =", ru1709_sell_yesterday)
print("ru1709_buy_yesterday =", ru1709_buy_yesterday)
print("ru1705_buy_yesterday =", ru1705_buy_yesterday)

print("position_detail_trade_yesterday")
for i in position_detail_trade_yesterday:
    print(i)